<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="/template/templateGeral.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui">

	<f:metadata>
		<f:viewAction action="#{solicitacaoBean.init}" />
	</f:metadata>

	<ui:define name="title_page">Solicitação Serviço</ui:define>

	<ui:define name="conteudo">
		<p:panel id="panelSolicitacao" header="Abrir solicitação" style="height:550px"
			menuTitle="Solicitar">

			<h:form id="formSolicitacao">
				<p:panelGrid columns="2" columnClasses="labelGrid, inputGrid"
					style="margin-top:10px; height:450px;" id="painelSolicita"  >
					
					<p:outputLabel value="Tipo de Trabalho: " />
					<h:panelGroup>
					<p:message for="tipoTrabalho"/>
					<p:selectOneMenu value="#{solicitacaoBean.solicitacao.tipoTrabalho}" required="true" requiredMessage="Escolha um tipo de trabalho">
						<f:selectItem itemLabel="Selecione" noSelectionOption="true" />
						<f:selectItems value="#{solicitacaoBean.tiposDeTrabalhos()}"
							var="item" itemLabel="#{item}" itemValue="#{item}"  id="tipoTrabalho"/>
					</p:selectOneMenu>
					
					</h:panelGroup>

					<p:outputLabel value="Equipamento: " />
					<h:panelGroup>
					<p:inputText value="#{solicitacaoBean.solicitacao.equipamento}"
						placeholder="Equipamento.." required="true" requiredMessage="Este campo é obrigatorio" id="equipamento"/>
						<p:message for="equipamento"/>
					</h:panelGroup>

					<p:outputLabel value="Componente: " />
					<h:panelGroup>
					<p:inputText value="#{solicitacaoBean.solicitacao.componente}" required="true" requiredMessage="Este campo é obrigatorio"
						placeholder="Componente do equipamento" size="25" id="componente"/>
						<p:message for="componente"/>
					</h:panelGroup>

					<p:outputLabel value="Descrição" />
					<h:panelGroup>
					<p:inputTextarea
						value="#{solicitacaoBean.solicitacao.descricaoAcao}"
						autoResize="true" cols="40" rows="5"
						placeholder="Descrição da ação a executar" required="true" requiredMessage="Este campo é obrigatorio" id="descricao"/>
						<p:message for="descricao"/>
					</h:panelGroup>
					<p:outputLabel value="" />
					<f:facet name="footer">
						<p:commandButton value="Cancelar" style="float:right"
							action="/index.xhtml?faces-redirect=true" />
						<p:commandButton value="Solicitar" style="float:right"
							action="#{solicitacaoBean.salvar}" update="@form">
							<f:setPropertyActionListener
								value="#{segurancaBean.colaboradorLogado.setor}"
								target="#{solicitacaoBean.solicitacao.setor}" />
						</p:commandButton>
					</f:facet>
				</p:panelGrid>
			</h:form>
			<p:outputPanel autoUpdate="true" id="tabelaDeSolicitacao">
				<p:dataTable var="solicitacao"
					value="#{solicitacaoBean.listaPorStatus}" id="tbSolicitacaoAberta">

					<p:column headerText="Tipo Trabalho">
						<p:outputLabel value="#{solicitacao.tipoTrabalho}" />
					</p:column>

					<p:column headerText="Equipamento">
						<p:outputLabel value="#{solicitacao.equipamento}" />
					</p:column>

					<p:column headerText="Componente">
						<p:outputLabel value="#{solicitacao.componente}" />
					</p:column>

					<p:column headerText="Data de Criação">
						<p:outputLabel value="#{solicitacao.dataCriacao}">
							<f:convertDateTime pattern="dd/MM/yyyy" type="both"
								locale="pt_BR" />
						</p:outputLabel>
					</p:column>

				</p:dataTable>
			</p:outputPanel>
		</p:panel>
	</ui:define>
</ui:composition>